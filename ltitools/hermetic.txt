Author.Plugin (component,model,controller)
hermetic/ltitools/
videoquiz
popquiz
quizlesson?

php artisan create:plugin hermetic.ltitools

php artisan create:controller hermetic.ltitools videoquiz
php artisan create:model hermetic.ltitools videoquiz
php artisan create:component hermetic.ltitools videoquiz

php artisan create:controller hermetic.ltitools popquiz
php artisan create:model hermetic.ltitools popquiz
php artisan create:component hermetic.ltitools popquiz

Popquiz : 
    could have several in a course. instance name should include/be quiz_name?
    no way to retrieve assignment id from post? 2967075
    grade as assignment


Videoquiz : Similar to Quizlesson
    create Assignment, insert with Editor?
    or Resource Selection? 
  
Instructor:
    - upload a video to use or select from list???
    - seek/play to a marker (time) click Add content
    - select quiz template? pre-defined color/style groups
    - select quiz from quizzes (question_banks)
    - select question
    - repeat until all questions in quiz are added?
    - save track file for cues with question ids
    
Student:
    - load selected video and track
    - after last question answered, auto submit quiz, graded as quiz
    

removed from component.php
    $this->page['recordId'] = $config->id;// UNUSED
    
    
    
error:
roots line 575
//case "Illuminate\Database\Eloquent\Collection":
case "October\Rain\Database\Collection":

had to switch in order to get quizzes from lms
timed out but data is there now : Home build 382
test on mediafiles server : build 316

october login error:
Hermetic\Ltitools\Updates\CreatePopquizzesTable::Hermetic\Ltitools\Updates\{closure}() must be an instance of October\Rain\Database\Schema\Blueprint, instance of Illuminate\Database\Schema\Blueprint given, 
called in /var/www/html/delphinium/vendor/laravel/framework/src/Illuminate/Database/Schema/Builder.php on line 129 and defined

Adjusted /updates/ to fix errors:

use Schema;
//use October\Rain\Database\Schema\Blueprint;
use October\Rain\Database\Updates\Migration;

class CreatePopquizzesTable extends Migration
{
    public function up()
    {
        //Schema::create('hermetic_ltitools_popquizzes', function(Blueprint $table) {
        Schema::create('hermetic_ltitools_popquizzes', function($table) {
            $table->engine = 'InnoDB';


LtiConfiguration :type = editor

But at first launch, courseID is Undefined
Popquiz.php line 194: $courseId = $_SESSION['courseID'];

SESSION variables get set in LtiConfiguration.php at doBltiHandshake()
Does it need to be sooner? or is editor not calling handshake

In Quizlession I solved the problem like so,
$_SESSION['courseID'] = \Input::get('custom_canvas_course_id');
$_SESSION['userID'] = \Input::get('custom_canvas_user_id');
$_SESSION['domain'] = \Input::get('custom_canvas_api_domain');
$_SESSION['lms'] = \Input::get('custom_canvas_lms');
$_SESSION['roles'] = \Input::get('roles');// I added this for Editor version of LtiConfiguration.php

next err: CanvasHelper
$token = \Crypt::decrypt($_SESSION['userToken']);


Solution:
type=editor is skipping the doBltiHandshake()
lti_message_type = ContentItemSelectionRequest

config.xml includes editor options & custom:
I removed ContentItemSelectionRequest from configuration.xml if $type == 'Editor', this needs to be a separate type in the dropdown?
<lticm:property name="message_type">ContentItemSelectionRequest</lticm:property>

Testing:
lti_message_type = basic-lti-launch-request

Of course this now breaks Quizlesson, unless another Type = contentItem is defined in LtiConfiguration.php

May need contentItemSelectionRequest in order for Instructor to inject the popquiz iframe. similar to quizlesson.

if contentItem is reinstated for type=Editor:
 LtiConfiguration.php set return_url and always doBltiHandshake
 
set iframe for content return_url 
 
<p><iframe style="width: 970px; height: 550px;" title="Pop Quiz" src="/courses/420908/external_tools/retrieve
?display=borderless
&amp;url=https%3A%2F%2Fmediafiles.uvu.edu%2Fdelphinium%2Fpopquiz" 
width="300" height="150" allowfullscreen="allowfullscreen" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen"></iframe></p>


2nd launch is basic-lti-launch-request
questions are store/retrieved from db so should be changable.

Need assignment id to submit score
$assignmentID = $_POST['custom_canvas_assignment_id'];
look at viewStudent
